(()=>{"use strict";class e{constructor(e){this._element=e,this.started=!1,this.goblin=null,this.interval=null,this.pos=-1,this.knocked=!1,this.knockedVal=0,this.miss=0}startGame(){this._createCells();const e=this._element.querySelectorAll(".cell");this._createGoblin(),this._addCellClickListeners(e),this._startGoblinMovement(e),this.started=!0,this._moveGoblin(e)}_addCellClickListeners(e){e.forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("withGoblin")&&(this.knocked=!0,this.knockedVal+=1,document.querySelector("input").value=this.knockedVal,this._resetGoblinMovement(e))}))}))}resetGame(){clearInterval(this.interval),this._element.innerHTML="",this.started=!1,document.querySelectorAll("input").forEach((e=>{e.value=0})),this.knockedVal=0,this.knocked=!1,this.miss=0}_createCells(){for(let e=0;e<16;e++){const e=document.createElement("div");e.classList.add("cell"),this._element.appendChild(e)}}_createGoblin(){const e=document.createElement("div");e.classList.add("goblin"),e.addEventListener("mouseenter",(()=>{e.classList.add("scale")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("scale")})),this.goblin=e}_moveGoblin(e){let t;do{t=this._getRandomInt(0,16)}while(this.pos===t);-1!==this.pos&&e[this.pos].classList.remove("withGoblin"),this.pos=t;const s=e[t];s.appendChild(this.goblin),s.classList.add("withGoblin")}_getRandomInt(e,t){return Math.floor(Math.random()*(t-e)+e)}_startGoblinMovement(e){this.interval=setInterval((()=>{this._moveGoblin(e),!1===this.knocked&&(this.miss+=1,document.querySelector("input.miss").value=this.miss),setTimeout((()=>{5===this.miss&&(alert("вы проиграли =("),this.resetGame())}),1)}),1e3)}_resetGoblinMovement(e){this._moveGoblin(e),clearInterval(this.interval),this._startGoblinMovement(e),this.knocked=!1}}document.addEventListener("DOMContentLoaded",(()=>{const t=new e(document.getElementById("gameField"));window.game=t;const s=document.querySelector("button.start"),i=document.querySelector("button.reset");s.addEventListener("click",(()=>{!t.started&&confirm("начать игру?")&&t.startGame()})),i.addEventListener("click",(()=>{t.started&&confirm("сбросить игру?")&&t.resetGame()}))}))})();